
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Frequently Asked Questions (FAQ) &#8212; pandas 0.22.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.22.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="rpy2 / R interface" href="r_interface.html" />
    <link rel="prev" title="Sparse data structures" href="sparse.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="r_interface.html" title="rpy2 / R interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sparse.html" title="Sparse data structures"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pandas 0.22.0 documentation</a> &#187;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What&#8217;s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Package overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="10min.html">10 Minutes to pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsintro.html">Intro to Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Essential Basic Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Working with Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="options.html">Options and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexing.html">Indexing and Selecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">MultiIndex / Advanced Indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="missing_data.html">Working with missing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l1"><a class="reference internal" href="merging.html">Merge, join, and concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="timedeltas.html">Time Deltas</a></li>
<li class="toctree-l1"><a class="reference internal" href="categorical.html">Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="style.html">Styling</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote_data.html">Remote Data Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="enhancingperf.html">Enhancing Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently Asked Questions (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dataframe-memory-usage">DataFrame memory usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-if-truth-statements-with-pandas">Using If/Truth Statements with pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bitwise-boolean">Bitwise boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-in-operator">Using the <code class="docutils literal"><span class="pre">in</span></code> operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nan-integer-na-values-and-na-type-promotions"><code class="docutils literal"><span class="pre">NaN</span></code>, Integer <code class="docutils literal"><span class="pre">NA</span></code> values and <code class="docutils literal"><span class="pre">NA</span></code> type promotions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choice-of-na-representation">Choice of <code class="docutils literal"><span class="pre">NA</span></code> representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#support-for-integer-na">Support for integer <code class="docutils literal"><span class="pre">NA</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#na-type-promotions"><code class="docutils literal"><span class="pre">NA</span></code> type promotions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#why-not-make-numpy-like-r">Why not make NumPy like R?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#differences-with-numpy">Differences with NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thread-safety">Thread-safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="#byte-ordering-issues">Byte-Ordering Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="r_interface.html">rpy2 / R interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem.html">pandas Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_r.html">Comparison with R / R libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_sql.html">Comparison with SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_sas.html">Comparison with SAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="frequently-asked-questions-faq">
<span id="gotchas"></span><h1>Frequently Asked Questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dataframe-memory-usage">
<span id="df-memory-usage"></span><h2>DataFrame memory usage<a class="headerlink" href="#dataframe-memory-usage" title="Permalink to this headline">¶</a></h2>
<p>The memory usage of a dataframe (including the index)
is shown when accessing the <code class="docutils literal"><span class="pre">info</span></code> method of a dataframe. A
configuration option, <code class="docutils literal"><span class="pre">display.memory_usage</span></code> (see <a class="reference internal" href="options.html#options"><span class="std std-ref">Options and Settings</span></a>),
specifies if the dataframe&#8217;s memory usage will be displayed when
invoking the <code class="docutils literal"><span class="pre">df.info()</span></code> method.</p>
<p>For example, the memory usage of the dataframe below is shown
when calling <code class="docutils literal"><span class="pre">df.info()</span></code>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>          <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">]</span>
<span class="gp">   ...: </span>

<span class="gp">In [2]: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="gp">   ...: </span>                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">dtypes</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;categorical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">RangeIndex: 5000 entries, 0 to 4999</span>
<span class="go">Data columns (total 8 columns):</span>
<span class="go">bool               5000 non-null bool</span>
<span class="go">complex128         5000 non-null complex128</span>
<span class="go">datetime64[ns]     5000 non-null datetime64[ns]</span>
<span class="go">float64            5000 non-null float64</span>
<span class="go">int64              5000 non-null int64</span>
<span class="go">object             5000 non-null object</span>
<span class="go">timedelta64[ns]    5000 non-null timedelta64[ns]</span>
<span class="go">categorical        5000 non-null category</span>
<span class="go">dtypes: bool(1), category(1), complex128(1), datetime64[ns](1), float64(1), int64(1), object(1), timedelta64[ns](1)</span>
<span class="go">memory usage: 289.1+ KB</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">+</span></code> symbol indicates that the true memory usage could be higher, because
pandas does not count the memory used by values in columns with
<code class="docutils literal"><span class="pre">dtype=object</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.1.</span></p>
</div>
<p>Passing <code class="docutils literal"><span class="pre">memory_usage='deep'</span></code> will enable a more accurate memory usage report,
that accounts for the full usage of the contained objects. This is optional
as it can be expensive to do this deeper introspection.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">RangeIndex: 5000 entries, 0 to 4999</span>
<span class="go">Data columns (total 8 columns):</span>
<span class="go">bool               5000 non-null bool</span>
<span class="go">complex128         5000 non-null complex128</span>
<span class="go">datetime64[ns]     5000 non-null datetime64[ns]</span>
<span class="go">float64            5000 non-null float64</span>
<span class="go">int64              5000 non-null int64</span>
<span class="go">object             5000 non-null object</span>
<span class="go">timedelta64[ns]    5000 non-null timedelta64[ns]</span>
<span class="go">categorical        5000 non-null category</span>
<span class="go">dtypes: bool(1), category(1), complex128(1), datetime64[ns](1), float64(1), int64(1), object(1), timedelta64[ns](1)</span>
<span class="go">memory usage: 425.6 KB</span>
</pre></div>
</div>
<p>By default the display option is set to <code class="docutils literal"><span class="pre">True</span></code> but can be explicitly
overridden by passing the <code class="docutils literal"><span class="pre">memory_usage</span></code> argument when invoking <code class="docutils literal"><span class="pre">df.info()</span></code>.</p>
<p>The memory usage of each column can be found by calling the <code class="docutils literal"><span class="pre">memory_usage</span></code>
method. This returns a Series with an index represented by column names
and memory usage of each column shown in bytes. For the dataframe above,
the memory usage of each column and the total memory usage of the
dataframe can be found with the memory_usage method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">Index                 80</span>
<span class="go">bool                5000</span>
<span class="go">complex128         80000</span>
<span class="go">datetime64[ns]     40000</span>
<span class="go">float64            40000</span>
<span class="go">int64              40000</span>
<span class="go">object             40000</span>
<span class="go">timedelta64[ns]    40000</span>
<span class="go">categorical        10920</span>
<span class="go">dtype: int64</span>

<span class="go"># total memory usage of dataframe</span>
<span class="gp">In [9]: </span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">                                                                                                                                                                                                                                                       Out[9]: 296000</span>
</pre></div>
</div>
<p>By default the memory usage of the dataframe&#8217;s index is shown in the
returned Series, the memory usage of the index can be suppressed by passing
the <code class="docutils literal"><span class="pre">index=False</span></code> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">bool                5000</span>
<span class="go">complex128         80000</span>
<span class="go">datetime64[ns]     40000</span>
<span class="go">float64            40000</span>
<span class="go">int64              40000</span>
<span class="go">object             40000</span>
<span class="go">timedelta64[ns]    40000</span>
<span class="go">categorical        10920</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>The memory usage displayed by the <code class="docutils literal"><span class="pre">info</span></code> method utilizes the
<code class="docutils literal"><span class="pre">memory_usage</span></code> method to determine the memory usage of a dataframe
while also formatting the output in human-readable units (base-2
representation; i.e., 1KB = 1024 bytes).</p>
<p>See also <a class="reference internal" href="categorical.html#categorical-memory"><span class="std std-ref">Categorical Memory Usage</span></a>.</p>
</div>
<div class="section" id="using-if-truth-statements-with-pandas">
<span id="gotchas-truth"></span><h2>Using If/Truth Statements with pandas<a class="headerlink" href="#using-if-truth-statements-with-pandas" title="Permalink to this headline">¶</a></h2>
<p>pandas follows the numpy convention of raising an error when you try to convert something to a <code class="docutils literal"><span class="pre">bool</span></code>.
This happens in a <code class="docutils literal"><span class="pre">if</span></code> or when using the boolean operations, <code class="docutils literal"><span class="pre">and</span></code>, <code class="docutils literal"><span class="pre">or</span></code>, or <code class="docutils literal"><span class="pre">not</span></code>.  It is not clear
what the result of</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]):</span>
<span class="go">     ...</span>
</pre></div>
</div>
<p>should be. Should it be <code class="docutils literal"><span class="pre">True</span></code> because it&#8217;s not zero-length? <code class="docutils literal"><span class="pre">False</span></code> because there are <code class="docutils literal"><span class="pre">False</span></code> values?
It is unclear, so instead, pandas raises a <code class="docutils literal"><span class="pre">ValueError</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]):</span>
<span class="go">    print(&quot;I was true&quot;)</span>
<span class="go">Traceback</span>
<span class="go">    ...</span>
<span class="go">ValueError: The truth value of an array is ambiguous. Use a.empty, a.any() or a.all().</span>
</pre></div>
</div>
<p>If you see that, you need to explicitly choose what you want to do with it (e.g., use <cite>any()</cite>, <cite>all()</cite> or <cite>empty</cite>).
or, you might want to compare if the pandas object is <code class="docutils literal"><span class="pre">None</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="go">       print(&quot;I was not None&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="n">was</span> <span class="ow">not</span> <span class="bp">None</span>
</pre></div>
</div>
<p>or return if <code class="docutils literal"><span class="pre">any</span></code> value is <code class="docutils literal"><span class="pre">True</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="go">       print(&quot;I am any&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="n">am</span> <span class="nb">any</span>
</pre></div>
</div>
<p>To evaluate single-element pandas objects in a boolean context, use the method <code class="docutils literal"><span class="pre">.bool()</span></code>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">True</span><span class="p">])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="gh">Out[11]: </span><span class="go">True</span>

<span class="gp">In [12]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="go">              Out[12]: False</span>

<span class="gp">In [13]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="bp">True</span><span class="p">]])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="go">                             Out[13]: True</span>

<span class="gp">In [14]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="bp">False</span><span class="p">]])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="go">                                           Out[14]: False</span>
</pre></div>
</div>
<div class="section" id="bitwise-boolean">
<h3>Bitwise boolean<a class="headerlink" href="#bitwise-boolean" title="Permalink to this headline">¶</a></h3>
<p>Bitwise boolean operators like <code class="docutils literal"><span class="pre">==</span></code> and <code class="docutils literal"><span class="pre">!=</span></code> return a boolean <code class="docutils literal"><span class="pre">Series</span></code>,
which is almost always what you want anyways.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">==</span> <span class="mi">4</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2    False</span>
<span class="go">3    False</span>
<span class="go">4     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="basics.html#basics-compare"><span class="std std-ref">boolean comparisons</span></a> for more examples.</p>
</div>
<div class="section" id="using-the-in-operator">
<h3>Using the <code class="docutils literal"><span class="pre">in</span></code> operator<a class="headerlink" href="#using-the-in-operator" title="Permalink to this headline">¶</a></h3>
<p>Using the Python <code class="docutils literal"><span class="pre">in</span></code> operator on a Series tests for membership in the
index, not membership among the values.</p>
<p>If this behavior is surprising, keep in mind that using <code class="docutils literal"><span class="pre">in</span></code> on a Python
dictionary tests keys, not values, and Series are dict-like.
To test for membership in the values, use the method <a class="reference internal" href="generated/pandas.Series.isin.html#pandas.Series.isin" title="pandas.Series.isin"><code class="xref py py-func docutils literal"><span class="pre">isin()</span></code></a>:</p>
<p>For DataFrames, likewise, <code class="docutils literal"><span class="pre">in</span></code> applies to the column axis,
testing for membership in the list of column names.</p>
</div>
</div>
<div class="section" id="nan-integer-na-values-and-na-type-promotions">
<h2><code class="docutils literal"><span class="pre">NaN</span></code>, Integer <code class="docutils literal"><span class="pre">NA</span></code> values and <code class="docutils literal"><span class="pre">NA</span></code> type promotions<a class="headerlink" href="#nan-integer-na-values-and-na-type-promotions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="choice-of-na-representation">
<h3>Choice of <code class="docutils literal"><span class="pre">NA</span></code> representation<a class="headerlink" href="#choice-of-na-representation" title="Permalink to this headline">¶</a></h3>
<p>For lack of <code class="docutils literal"><span class="pre">NA</span></code> (missing) support from the ground up in NumPy and Python in
general, we were given the difficult choice between either</p>
<ul class="simple">
<li>A <em>masked array</em> solution: an array of data and an array of boolean values
indicating whether a value is there or is missing</li>
<li>Using a special sentinel value, bit pattern, or set of sentinel values to
denote <code class="docutils literal"><span class="pre">NA</span></code> across the dtypes</li>
</ul>
<p>For many reasons we chose the latter. After years of production use it has
proven, at least in my opinion, to be the best decision given the state of
affairs in NumPy and Python in general. The special value <code class="docutils literal"><span class="pre">NaN</span></code>
(Not-A-Number) is used everywhere as the <code class="docutils literal"><span class="pre">NA</span></code> value, and there are API
functions <code class="docutils literal"><span class="pre">isna</span></code> and <code class="docutils literal"><span class="pre">notna</span></code> which can be used across the dtypes to
detect NA values.</p>
<p>However, it comes with it a couple of trade-offs which I most certainly have
not ignored.</p>
</div>
<div class="section" id="support-for-integer-na">
<span id="gotchas-intna"></span><h3>Support for integer <code class="docutils literal"><span class="pre">NA</span></code><a class="headerlink" href="#support-for-integer-na" title="Permalink to this headline">¶</a></h3>
<p>In the absence of high performance <code class="docutils literal"><span class="pre">NA</span></code> support being built into NumPy from
the ground up, the primary casualty is the ability to represent NAs in integer
arrays. For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">))</span>

<span class="gp">In [16]: </span><span class="n">s</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">a    1</span>
<span class="go">b    2</span>
<span class="go">c    3</span>
<span class="go">d    4</span>
<span class="go">e    5</span>
<span class="go">dtype: int64</span>

<span class="gp">In [17]: </span><span class="n">s</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">                                                          Out[17]: dtype(&#39;int64&#39;)</span>

<span class="gp">In [18]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">])</span>

<span class="gp">In [19]: </span><span class="n">s2</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">a    1.0</span>
<span class="go">b    2.0</span>
<span class="go">c    3.0</span>
<span class="go">f    NaN</span>
<span class="go">u    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">In [20]: </span><span class="n">s2</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">                                                                      Out[20]: dtype(&#39;float64&#39;)</span>
</pre></div>
</div>
<p>This trade-off is made largely for memory and performance reasons, and also so
that the resulting Series continues to be &#8220;numeric&#8221;. One possibility is to use
<code class="docutils literal"><span class="pre">dtype=object</span></code> arrays instead.</p>
</div>
<div class="section" id="na-type-promotions">
<h3><code class="docutils literal"><span class="pre">NA</span></code> type promotions<a class="headerlink" href="#na-type-promotions" title="Permalink to this headline">¶</a></h3>
<p>When introducing NAs into an existing Series or DataFrame via <code class="docutils literal"><span class="pre">reindex</span></code> or
some other means, boolean and integer types will be promoted to a different
dtype in order to store the NAs. These are summarized by this table:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Typeclass</th>
<th class="head">Promotion dtype for storing NAs</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">floating</span></code></td>
<td>no change</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">object</span></code></td>
<td>no change</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">integer</span></code></td>
<td>cast to <code class="docutils literal"><span class="pre">float64</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">boolean</span></code></td>
<td>cast to <code class="docutils literal"><span class="pre">object</span></code></td>
</tr>
</tbody>
</table>
<p>While this may seem like a heavy trade-off, I have found very few cases where
this is an issue in practice i.e. storing values greater than 2**53. Some
explanation for the motivation is in the next section.</p>
</div>
<div class="section" id="why-not-make-numpy-like-r">
<h3>Why not make NumPy like R?<a class="headerlink" href="#why-not-make-numpy-like-r" title="Permalink to this headline">¶</a></h3>
<p>Many people have suggested that NumPy should simply emulate the <code class="docutils literal"><span class="pre">NA</span></code> support
present in the more domain-specific statistical programming language <a class="reference external" href="https://r-project.org">R</a>. Part of the reason is the NumPy type hierarchy:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Typeclass</th>
<th class="head">Dtypes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">numpy.floating</span></code></td>
<td><code class="docutils literal"><span class="pre">float16,</span> <span class="pre">float32,</span> <span class="pre">float64,</span> <span class="pre">float128</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">numpy.integer</span></code></td>
<td><code class="docutils literal"><span class="pre">int8,</span> <span class="pre">int16,</span> <span class="pre">int32,</span> <span class="pre">int64</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">numpy.unsignedinteger</span></code></td>
<td><code class="docutils literal"><span class="pre">uint8,</span> <span class="pre">uint16,</span> <span class="pre">uint32,</span> <span class="pre">uint64</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">numpy.object_</span></code></td>
<td><code class="docutils literal"><span class="pre">object_</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">numpy.bool_</span></code></td>
<td><code class="docutils literal"><span class="pre">bool_</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">numpy.character</span></code></td>
<td><code class="docutils literal"><span class="pre">string_,</span> <span class="pre">unicode_</span></code></td>
</tr>
</tbody>
</table>
<p>The R language, by contrast, only has a handful of built-in data types:
<code class="docutils literal"><span class="pre">integer</span></code>, <code class="docutils literal"><span class="pre">numeric</span></code> (floating-point), <code class="docutils literal"><span class="pre">character</span></code>, and
<code class="docutils literal"><span class="pre">boolean</span></code>. <code class="docutils literal"><span class="pre">NA</span></code> types are implemented by reserving special bit patterns for
each type to be used as the missing value. While doing this with the full NumPy
type hierarchy would be possible, it would be a more substantial trade-off
(especially for the 8- and 16-bit data types) and implementation undertaking.</p>
<p>An alternate approach is that of using masked arrays. A masked array is an
array of data with an associated boolean <em>mask</em> denoting whether each value
should be considered <code class="docutils literal"><span class="pre">NA</span></code> or not. I am personally not in love with this
approach as I feel that overall it places a fairly heavy burden on the user and
the library implementer. Additionally, it exacts a fairly high performance cost
when working with numerical data compared with the simple approach of using
<code class="docutils literal"><span class="pre">NaN</span></code>. Thus, I have chosen the Pythonic &#8220;practicality beats purity&#8221; approach
and traded integer <code class="docutils literal"><span class="pre">NA</span></code> capability for a much simpler approach of using a
special value in float and object arrays to denote <code class="docutils literal"><span class="pre">NA</span></code>, and promoting
integer arrays to floating when NAs must be introduced.</p>
</div>
</div>
<div class="section" id="differences-with-numpy">
<h2>Differences with NumPy<a class="headerlink" href="#differences-with-numpy" title="Permalink to this headline">¶</a></h2>
<p>For Series and DataFrame objects, <code class="docutils literal"><span class="pre">var</span></code> normalizes by <code class="docutils literal"><span class="pre">N-1</span></code> to produce
unbiased estimates of the sample variance, while NumPy&#8217;s <code class="docutils literal"><span class="pre">var</span></code> normalizes
by N, which measures the variance of the sample. Note that <code class="docutils literal"><span class="pre">cov</span></code>
normalizes by <code class="docutils literal"><span class="pre">N-1</span></code> in both pandas and NumPy.</p>
</div>
<div class="section" id="thread-safety">
<h2>Thread-safety<a class="headerlink" href="#thread-safety" title="Permalink to this headline">¶</a></h2>
<p>As of pandas 0.11, pandas is not 100% thread safe. The known issues relate to
the <code class="docutils literal"><span class="pre">DataFrame.copy</span></code> method. If you are doing a lot of copying of DataFrame
objects shared among threads, we recommend holding locks inside the threads
where the data copying occurs.</p>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/13592618/python-pandas-dataframe-thread-safe">this link</a>
for more information.</p>
</div>
<div class="section" id="byte-ordering-issues">
<h2>Byte-Ordering Issues<a class="headerlink" href="#byte-ordering-issues" title="Permalink to this headline">¶</a></h2>
<p>Occasionally you may have to deal with data that were created on a machine with
a different byte order than the one on which you are running Python. A common symptom of this issue is an error like</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Traceback</span>
    <span class="o">...</span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="n">Big</span><span class="o">-</span><span class="n">endian</span> <span class="nb">buffer</span> <span class="ow">not</span> <span class="n">supported</span> <span class="n">on</span> <span class="n">little</span><span class="o">-</span><span class="n">endian</span> <span class="n">compiler</span>
</pre></div>
</div>
<p>To deal
with this issue you should convert the underlying NumPy array to the native
system byte order <em>before</em> passing it to Series/DataFrame/Panel constructors
using something similar to the following:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="s1">&#39;&gt;i4&#39;</span><span class="p">)</span> <span class="c1"># big endian</span>

<span class="gp">In [22]: </span><span class="n">newx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span><span class="o">.</span><span class="n">newbyteorder</span><span class="p">()</span> <span class="c1"># force native byteorder</span>

<span class="gp">In [23]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">newx</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.byteswapping.html">the NumPy documentation on byte order</a> for more
details.</p>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="r_interface.html" title="rpy2 / R interface"
             >next</a> |</li>
        <li class="right" >
          <a href="sparse.html" title="Sparse data structures"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pandas 0.22.0 documentation</a> &#187;</li> 
      </ul>
    </div>
<style type="text/css">
    .scrollToTop {
        text-align: center;
        font-weight: bold;
        position: fixed;
        bottom: 60px;
        right: 40px;
        display: none;
    }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
$(document).ready(function() {
    //Check to see if the window is top if not then display button
    $(window).scroll(function() {
        if ($(this).scrollTop() > 200) {
            $('.scrollToTop').fadeIn();
        } else {
            $('.scrollToTop').fadeOut();
        }
    });

    //Click event to scroll to top
    $('.scrollToTop').click(function() {
        $('html, body').animate({
            scrollTop: 0
        }, 500);
        return false;
    });
});
</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27880019-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>